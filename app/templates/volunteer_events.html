{% extends "citizen_base.html" %}

{% block content %}

<h2>Upcoming Cleaning Events</h2>
<p class="text-muted mb-4">
    Join events and earn carbon credit points.
</p>

<div class="card p-4 shadow-sm">

<table class="table">
    <thead>
        <tr>
            <th>Title</th>
            <th>Area</th>
            <th>Date</th>
            <th>Credits</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>

    {% for event in events %}

        <tr>

            <td>{{ event[1] }}</td>
            <td>{{ event[2] }}</td>
            <td>{{ event[3] }}</td>
            <td>{{ event[4] }}</td>

            <!-- EVENT STATUS -->
            <td>
                {% if event[5] == "Completed" %}
                    <span class="badge bg-success">Completed</span>
                {% else %}
                    <span class="badge bg-primary">Active</span>
                {% endif %}
            </td>

            <!-- ACTION BUTTON -->
            <td>

                {% if event[5] == "Completed" %}

                    <span class="badge bg-secondary">
                        Closed
                    </span>

                {% elif event[0] in joined_event_ids %}

                    <span class="badge bg-success">
                        Joined
                    </span>

                {% else %}

                    <a href="{{ url_for('auth.join_event', event_id=event[0]) }}"
                       class="btn btn-success btn-sm">
                       Join Event
                    </a>

                {% endif %}

            </td>

        </tr>

    {% endfor %}

    </tbody>

</table>

</div>

{% endblock %}
